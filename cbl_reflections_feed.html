<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>InnovatorsMakerCBL | Reflections</title>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css" rel="stylesheet">

    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">


    <style type="text/css">
        .social-body {
            position: relative;
        }

        .reflection-statement-text {
            width: 70%;
            text-align: justify;
            font-size: larger;
        }

        .reflectionsChart {
            position: absolute;
            right: 20px;
            top: -80px;
        }
        .pending-reflection-warning {
            color: red;
            font-weight: 700;
        }

        .reflection-text {
            font-size: larger;
            text-align: justify;
        }
    </style>

</head>

<body>

    <div id="wrapper">

    <nav class="navbar-default navbar-static-side" role="navigation">
        <div class="sidebar-collapse">
            <ul class="nav metismenu" id="side-menu">
                <li class="nav-header">
                    <div class="dropdown profile-element"> <span>
                            <img alt="image" class="img-circle" src="img/profile_small.jpg" />
                             </span>
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="clear"> <span class="block m-t-xs"> <strong id="user-name" class="font-bold">David Williams</strong>
                             </span> <span class="text-muted text-xs block">Art Director <b class="caret"></b></span> </span> </a>
                        <ul class="dropdown-menu animated fadeInRight m-t-xs">
                            <li><a href="profile.html">Profile</a></li>
                            <li><a href="contacts.html">Contacts</a></li>
                            <li><a href="mailbox.html">Mailbox</a></li>
                            <li class="divider"></li>
                            <li><a href="cbl_login_two_columns.html">Logout</a></li>
                        </ul>
                    </div>
                    <div class="logo-element">
                        IN+
                    </div>
                </li>
                <li>
                    <a href="mailbox.html"><i class="fa fa-envelope"></i> <span class="nav-label">Reflections </span><span class="label label-warning pull-right"><span class="num-pending-reflections">16</span>/<span class="num-total-reflections">24</span></span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="mailbox.html">Inbox</a></li>
                        <li><a href="mail_detail.html">Email view</a></li>
                        <li><a href="mail_compose.html">Compose email</a></li>
                        <li><a href="email_template.html">Email templates</a></li>
                    </ul>
                </li>

                <li>
                    <a href="index.html"><i class="fa fa-th-large"></i> <span class="nav-label">Dashboards</span> <span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="index.html">Dashboard v.1</a></li>
                        <li><a href="dashboard_2.html">Dashboard v.2</a></li>
                        <li><a href="dashboard_3.html">Dashboard v.3</a></li>
                        <li><a href="dashboard_4_1.html">Dashboard v.4</a></li>
                    </ul>
                </li>
                <li>
                    <a href="layouts.html"><i class="fa fa-diamond"></i> <span class="nav-label">Layouts</span></a>
                </li>
                <li>
                    <a href="#"><i class="fa fa-bar-chart-o"></i> <span class="nav-label">Graphs</span><span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="graph_flot.html">Flot Charts</a></li>
                        <li><a href="graph_morris.html">Morris.js Charts</a></li>
                        <li><a href="graph_rickshaw.html">Rickshaw Charts</a></li>
                        <li><a href="graph_chartjs.html">Chart.js</a></li>
                        <li><a href="graph_chartist.html">Chartist</a></li>
                        <li><a href="graph_peity.html">Peity Charts</a></li>
                        <li><a href="graph_sparkline.html">Sparkline Charts</a></li>
                    </ul>
                </li>
                <li>
                    <a href="mailbox.html"><i class="fa fa-envelope"></i> <span class="nav-label">Mailbox </span><span class="label label-warning pull-right">16/24</span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="mailbox.html">Inbox</a></li>
                        <li><a href="mail_detail.html">Email view</a></li>
                        <li><a href="mail_compose.html">Compose email</a></li>
                        <li><a href="email_template.html">Email templates</a></li>
                    </ul>
                </li>
                <li>
                    <a href="metrics.html"><i class="fa fa-pie-chart"></i> <span class="nav-label">Metrics</span> <span class="label label-primary pull-right">NEW</span> </a>
                </li>
                <li>
                    <a href="widgets.html"><i class="fa fa-flask"></i> <span class="nav-label">Widgets</span></a>
                </li>
                <li>
                    <a href="#"><i class="fa fa-edit"></i> <span class="nav-label">Forms</span><span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="form_basic.html">Basic form</a></li>
                        <li><a href="form_advanced.html">Advanced Plugins</a></li>
                        <li><a href="form_wizard.html">Wizard</a></li>
                        <li><a href="form_file_upload.html">File Upload</a></li>
                        <li><a href="form_editors.html">Text Editor</a></li>
                    </ul>
                </li>
                <li class="active">
                    <a href="#"><i class="fa fa-desktop"></i> <span class="nav-label">App Views</span>  <span class="pull-right label label-primary">SPECIAL</span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="contacts.html">Contacts</a></li>
                        <li><a href="profile.html">Profile</a></li>
                        <li><a href="projects.html">Projects</a></li>
                        <li><a href="project_detail.html">Project detail</a></li>
                        <li><a href="teams_board.html">Teams board</a></li>
                        <li class="active"><a href="social_feed.html">Social feed</a></li>
                        <li><a href="clients.html">Clients</a></li>
                        <li><a href="full_height.html">Outlook view</a></li>
                        <li><a href="file_manager.html">File manager</a></li>
                        <li><a href="calendar.html">Calendar</a></li>
                        <li><a href="issue_tracker.html">Issue tracker</a></li>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="article.html">Article</a></li>
                        <li><a href="faq.html">FAQ</a></li>
                        <li><a href="timeline.html">Timeline</a></li>
                        <li><a href="pin_board.html">Pin board</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#"><i class="fa fa-files-o"></i> <span class="nav-label">Other Pages</span><span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="search_results.html">Search results</a></li>
                        <li><a href="lockscreen.html">Lockscreen</a></li>
                        <li><a href="invoice.html">Invoice</a></li>
                        <li><a href="login.html">Login</a></li>
                        <li><a href="login_two_columns.html">Login v.2</a></li>
                        <li><a href="forgot_password.html">Forget password</a></li>
                        <li><a href="register.html">Register</a></li>
                        <li><a href="404.html">404 Page</a></li>
                        <li><a href="500.html">500 Page</a></li>
                        <li><a href="empty_page.html">Empty page</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#"><i class="fa fa-globe"></i> <span class="nav-label">Miscellaneous</span><span class="label label-info pull-right">NEW</span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="toastr_notifications.html">Notification</a></li>
                        <li><a href="nestable_list.html">Nestable list</a></li>
                        <li><a href="agile_board.html">Agile board</a></li>
                        <li><a href="timeline_2.html">Timeline v.2</a></li>
                        <li><a href="diff.html">Diff</a></li>
                        <li><a href="sweetalert.html">Sweet alert</a></li>
                        <li><a href="idle_timer.html">Idle timer</a></li>
                        <li><a href="spinners.html">Spinners</a></li>
                        <li><a href="tinycon.html">Live favicon</a></li>
                        <li><a href="google_maps.html">Google maps</a></li>
                        <li><a href="code_editor.html">Code editor</a></li>
                        <li><a href="modal_window.html">Modal window</a></li>
                        <li><a href="forum_main.html">Forum view</a></li>
                        <li><a href="validation.html">Validation</a></li>
                        <li><a href="tree_view.html">Tree view</a></li>
                        <li><a href="chat_view.html">Chat view</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#"><i class="fa fa-flask"></i> <span class="nav-label">UI Elements</span><span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="typography.html">Typography</a></li>
                        <li><a href="icons.html">Icons</a></li>
                        <li><a href="draggable_panels.html">Draggable Panels</a></li>
                        <li><a href="buttons.html">Buttons</a></li>
                        <li><a href="video.html">Video</a></li>
                        <li><a href="tabs_panels.html">Panels</a></li>
                        <li><a href="tabs.html">Tabs</a></li>
                        <li><a href="notifications.html">Notifications & Tooltips</a></li>
                        <li><a href="badges_labels.html">Badges, Labels, Progress</a></li>
                    </ul>
                </li>

                <li>
                    <a href="grid_options.html"><i class="fa fa-laptop"></i> <span class="nav-label">Grid options</span></a>
                </li>
                <li>
                    <a href="#"><i class="fa fa-table"></i> <span class="nav-label">Tables</span><span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="table_basic.html">Static Tables</a></li>
                        <li><a href="table_data_tables.html">Data Tables</a></li>
                        <li><a href="table_foo_table.html">Foo Tables</a></li>
                        <li><a href="jq_grid.html">jqGrid</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#"><i class="fa fa-shopping-cart"></i> <span class="nav-label">E-commerce</span><span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="ecommerce_products_grid.html">Products grid</a></li>
                        <li><a href="ecommerce_product_list.html">Products list</a></li>
                        <li><a href="ecommerce_product.html">Product edit</a></li>
                        <li><a href="ecommerce-orders.html">Orders</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#"><i class="fa fa-picture-o"></i> <span class="nav-label">Gallery</span><span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level collapse">
                        <li><a href="basic_gallery.html">Lightbox Gallery</a></li>
                        <li><a href="carousel.html">Bootstrap Carusela</a></li>

                    </ul>
                </li>
                <li>
                    <a href="#"><i class="fa fa-sitemap"></i> <span class="nav-label">Menu Levels </span><span class="fa arrow"></span></a>
                    <ul class="nav nav-second-level collapse">
                        <li>
                            <a href="#">Third Level <span class="fa arrow"></span></a>
                            <ul class="nav nav-third-level">
                                <li>
                                    <a href="#">Third Level Item</a>
                                </li>
                                <li>
                                    <a href="#">Third Level Item</a>
                                </li>
                                <li>
                                    <a href="#">Third Level Item</a>
                                </li>

                            </ul>
                        </li>
                        <li><a href="#">Second Level Item</a></li>
                        <li>
                            <a href="#">Second Level Item</a></li>
                        <li>
                            <a href="#">Second Level Item</a></li>
                    </ul>
                </li>
                <li>
                    <a href="css_animation.html"><i class="fa fa-magic"></i> <span class="nav-label">CSS Animations </span><span class="label label-info pull-right">62</span></a>
                </li>
                <li class="landing_link">
                    <a target="_blank" href="landing.html"><i class="fa fa-star"></i> <span class="nav-label">Landing Page</span> <span class="label label-warning pull-right">NEW</span></a>
                </li>
                <li class="special_link">
                    <a href="package.html"><i class="fa fa-database"></i> <span class="nav-label">Package</span></a>
                </li>
            </ul>

        </div>
    </nav>

        <div id="page-wrapper" class="gray-bg">
        <div class="row border-bottom">
        <nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0">
        <div class="navbar-header">
            <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>
            <form role="search" class="navbar-form-custom" action="search_results.html">
                <div class="form-group">
                    <input type="text" placeholder="Search for something..." class="form-control" name="top-search" id="top-search">
                </div>
            </form>
        </div>
            <ul class="nav navbar-top-links navbar-right">
                <li>
                    <span class="m-r-sm text-muted welcome-message">Welcome to INSPINIA+ Admin Theme.</span>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                        <i class="fa fa-envelope"></i>  <span class="label label-warning">16</span>
                    </a>
                    <ul class="dropdown-menu dropdown-messages">
                        <li>
                            <div class="dropdown-messages-box">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="img/a7.jpg">
                                </a>
                                <div class="media-body">
                                    <small class="pull-right">46h ago</small>
                                    <strong>Mike Loreipsum</strong> started following <strong>Monica Smith</strong>. <br>
                                    <small class="text-muted">3 days ago at 7:58 pm - 10.06.2014</small>
                                </div>
                            </div>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <div class="dropdown-messages-box">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="img/a4.jpg">
                                </a>
                                <div class="media-body ">
                                    <small class="pull-right text-navy">5h ago</small>
                                    <strong>Chris Johnatan Overtunk</strong> started following <strong>Monica Smith</strong>. <br>
                                    <small class="text-muted">Yesterday 1:21 pm - 11.06.2014</small>
                                </div>
                            </div>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <div class="dropdown-messages-box">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="img/profile.jpg">
                                </a>
                                <div class="media-body ">
                                    <small class="pull-right">23h ago</small>
                                    <strong>Monica Smith</strong> love <strong>Kim Smith</strong>. <br>
                                    <small class="text-muted">2 days ago at 2:30 am - 11.06.2014</small>
                                </div>
                            </div>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <div class="text-center link-block">
                                <a href="mailbox.html">
                                    <i class="fa fa-envelope"></i> <strong>Read All Messages</strong>
                                </a>
                            </div>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                        <i class="fa fa-bell"></i>  <span class="label label-primary">8</span>
                    </a>
                    <ul class="dropdown-menu dropdown-alerts">
                        <li>
                            <a href="mailbox.html">
                                <div>
                                    <i class="fa fa-envelope fa-fw"></i> You have 16 messages
                                    <span class="pull-right text-muted small">4 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="profile.html">
                                <div>
                                    <i class="fa fa-twitter fa-fw"></i> 3 New Followers
                                    <span class="pull-right text-muted small">12 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="grid_options.html">
                                <div>
                                    <i class="fa fa-upload fa-fw"></i> Server Rebooted
                                    <span class="pull-right text-muted small">4 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <div class="text-center link-block">
                                <a href="notifications.html">
                                    <strong>See All Alerts</strong>
                                    <i class="fa fa-angle-right"></i>
                                </a>
                            </div>
                        </li>
                    </ul>
                </li>


                <li>
                    <a id="link-logout" href="cbl_login_two_columns.html">
                        <i class="fa fa-sign-out"></i> Log out
                    </a>
                </li>
            </ul>

        </nav>
        </div>
            <div class="row wrapper border-bottom white-bg page-heading">
                <div class="col-lg-10">
                    <h2>Reflections</h2>
                    <ol class="breadcrumb">
                        <li>
                            <a href="index.html">Home</a>
                        </li>
                        <li>
                            <a>Bepid 2016</a>
                        </li>
                        <li>
                            <a>Sprint #0</a>
                        </li>
                        <li class="active">
                            <strong>Reflections</strong>
                        </li>
                    </ol>
                </div>
                <div class="col-lg-2">

                </div>
            </div>
            <div class="wrapper wrapper-content  animated fadeInRight">
                <div class="row">

                    <div class="col-lg-12">
                        <div class="ibox">
                            <div class="ibox-content text-center">

                            <button id="btn-new-reflection" type="button" class="btn btn-primary" data-toggle="modal" data-target="#newReflectionModal">
                                propose a new reflection to the class
                            </button>
                            <div class="modal inmodal" id="newReflectionModal" tabindex="-1" role="dialog" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content animated">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                            <h4 class="modal-title">New Reflection</h4>
                                            <small class="font-bold">Propose a new reflection to your class</small>
                                        </div>
                                        <div class="new-reflection-modal-body modal-body">
                                        <style type="text/css">
                                            .new-reflection-modal-body {
                                                padding: 0;
                                            }

                                            .new-reflection-textarea {
                                                width: 100%;
                                                padding: 10px;
                                                border: none;
                                            }
                                        </style>
                                            <textarea class="new-reflection-textarea" rows="10" placeholder="in this activity..."></textarea>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
                                            <button id="btn-save-new-reflection" type="button" class="btn btn-primary">Save reflection</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            </div>

                        </div>
                        <div class="reflections-feed">
                            <div class="social-feed-box" reflectionId="">
                                <div class="social-avatar">
                                    <a href="" class="pull-left">
                                        <img alt="image" src="img/a1.jpg">
                                    </a>
                                    <div class="media-body">
                                        <a class="reflection-statement-author-name" href="#">
                                            Andrew Williams
                                        </a>
                                        <small class="text-muted">Today 4:21 pm - 12.06.2014</small>
                                    </div>
                                </div>
                                <div class="social-body">
                                    <p class="reflection-statement-text"></p>
                                    <form class="form-inline">
                                        <div class="form-group">
                                            <label for="exampleInputEmail2" class="sr-only">Email address</label>
                                            <input type="email" placeholder="Enter email" id="inputEmail" class="form-control">
                                        </div>
                                        <div class="user-exists form-group hide">
                                            <label for="inputFirstName" class="sr-only">First Name</label>
                                            <input type="text" placeholder="first name" id="inputFirstName" class="form-control">
                                        </div>
                                        <div class="user-exists form-group hide">
                                            <label for="inputFirstName" class="sr-only">Last Name</label>
                                            <input type="text" placeholder="last name" id="inputLastName" class="form-control">
                                        </div>
                                        <div class="user-exists form-group hide">
                                            <label for="inputReflectionText" class="sr-only">Reflection</label>
                                            <input type="text" placeholder="...tonite" id="inputReflectionText" class="form-control">
                                        </div>
                                        <div>
                                            <textarea id="reflections-textarea"></textarea>
                                        </div>
                                        <a href="#" class="btn-save-reflection btn btn-white">save</a>
                                    </form> 
                                </div>
                                <div class="teachers-reflections">
                                    <div class="teacher-reflection">
                                        <div class="social-avatar">
                                            <div class="media-body">
                                                <a href="#">
                                                    @<span class="teacher-reflection-author">Cristiano Araújo</span>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="social-body">
                                            <p class="teacher-reflection-statement-text">Está ficando claro que devemos estimular os alunos não programadores a utilizarem ferramentas como o CodeAcademy que estimulam a autonomia no aprendizado. Assim como estimular os alunos programadores a proporem novos exercícios para os alunos não programadores.</p>
                                        </div>                                         
                                    </div>
                                </div>                               
                                <div class="social-footer">
                                    <div class="social-comment">
                                        <a href="" class="pull-left">
                                            <img alt="image" src="img/a1.jpg">
                                        </a>
                                        <div class="media-body">
                                            <a class="reflection-author-name" href="#">
                                                Andrew Williams
                                            </a>
                                            <span class="reflection-text"><span class="pending-reflection-warning">REFLECTION PENDING</span></span>
                                            <br/>
                                            <small class="text-muted">12.06.2014</small>
                                        </div>
                                    </div>
                                </div>
                                <button type="button" data-toggle="modal" data-target="#new-teacher-reflection-modal" class="btn-new-teacher-reflection btn btn-block btn-outline btn-primary">I have learned from these reflections that... </button>
                                <div class="modal inmodal" id="new-teacher-reflection-modal" tabindex="-1" role="dialog" aria-hidden="true" student-reflection-statement-id="" teacher-reflection-statement-id="P34QuDoziO">
                                    <div class="modal-dialog">
                                        <div class="modal-content animated">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                                <h4 class="modal-title">Teacher Reflection</h4>
                                                <small class="font-bold">I have learned from these reflections that...</small>
                                            </div>
                                            <div class="new-reflection-modal-body modal-body">
                                            <style type="text/css">
                                                .new-reflection-modal-body {
                                                    padding: 0;
                                                }

                                                .new-reflection-textarea {
                                                    width: 100%;
                                                    padding: 10px;
                                                    border: none;
                                                }
                                            </style>
                                                <textarea class="new-reflection-textarea" rows="10"placeholder="in this activity..."></textarea>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
                                                <button id="btn-save-new-teacher-reflection" type="button" class="btn btn-primary">Save reflection</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

        <div class="footer">
            <div class="pull-right">
                10GB of <strong>250GB</strong> Free.
            </div>
            <div>
                <strong>Copyright</strong> Example Company &copy; 2014-2015
            </div>
        </div>

        </div>
        </div>



    <!-- Mainly scripts -->
    <script src="js/jquery-2.1.1.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

    <!-- Custom and plugin javascript -->
    <script src="js/inspinia.js"></script>
    <script src="js/plugins/pace/pace.min.js"></script>
    <script type="text/javascript" src="js/underscore-1.8.3.js"></script>

    <script type="text/javascript" src="js/peg-0.9.0.min.js"></script>
    <script type="text/javascript" src="js/reflections_parser.js"></script>

    <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.2.18.min.js"></script>
    <script type="text/javascript">
        Parse.initialize("YALt9tjcUpW61Hz5aIPYbehm9uCgh5NXXRVM18T6", "5wwhJ6hfqu8cG4s6jMKMQWrmImiQKDTE9trvgL6x");
    </script>

    <script type="text/javascript">
        var $reflectionStatementRef = $('.social-feed-box');
        var $socialMediaFooterRef = $reflectionStatementRef.find('.social-footer');
        var $socialCommentRef = $socialMediaFooterRef.find('.social-comment');

        function updateReflectionsMenu(statements) {
            var numReflections = 0;
            var numPendingReflections = 0;
            for (var i = 0; i < statements.length; i++) {
                var reflections = statements[i].get('reflections');
                numReflections += reflections.length;
                for (var j = 0; j < reflections.length; j++) {
                    var isDone = reflections[j].get('isDone');

                    console.log(reflections[j].id + ': ' + isDone);
                    if (!isDone) {
                        numPendingReflections++;
                    }
                }
            }
            $('.num-pending-reflections').text(numPendingReflections);
            $('.num-total-reflections').text(numReflections);
        }

        function updateReflectionStatement(statementId) {     
            var ReflectionStatement = Parse.Object.extend('ReflectionStatement');
            var statementQuery = new Parse.Query(ReflectionStatement);
            statementQuery.include('reflections.author');

            statementQuery.get(statementId).then(function(statement) {
                var $reflectionStatement = $('.social-feed-box[reflectionId=' + statement.id + ']');
                var $socialFooter = $reflectionStatement.find('.social-footer');
                $socialFooter.empty();

                var reflections = statement.get('reflections');
                alert(reflections.length);

                var numDone = 0;
                var numPending = 0;
                var numLate = 0;

                for (var j = 0; j < reflections.length; j++) {
                    var $socialComment = $socialCommentRef.clone();
                    $socialComment.find('.reflection-author-name').text(reflections[j].get('author').get('name'));

                    if(reflections[j].get('text') != '') {
                        $socialComment.find('.reflection-text').text(reflections[j].get('text'));
                    } 

                    if (reflections[j].get('isDone')) {
                        $socialComment.find('.reflection-status-label').text('done');
                        $socialComment.find('.reflection-status-label').addClass('label-primary');
                    }else {
                        $socialComment.find('.reflection-status-label').text('pending');
                        $socialComment.find('.reflection-status-label').addClass('label-danger');                            
                    }

                    $socialComment.appendTo($socialFooter);
                }

                $canvas = $reflectionStatement.find('canvas');
            })
        }

        function displayReflectionStatements(statements) {
            if (statements.length > 0) {
                $('.reflections-feed').empty();
                for (i = 0; i < statements.length; i++) {
                    $reflectionStatement = $reflectionStatementRef.clone().detach();
                    $teachersReflections = $reflectionStatement.find('.teachers-reflections').empty();
                    $teacherReflectionRef = $reflectionStatementRef.find('.teacher-reflection').clone().detach();
                    $reflectionStatement.find('.reflection-statement-text').text(statements[i].get('text'));
                    $reflectionStatement.find('.reflection-statement-author-name').text(statements[i].get('author').get('name'));
                    $reflectionStatement.attr('reflectionId', statements[i].id);
                    $reflectionStatement.appendTo($('.reflections-feed'));

                    var $socialMediaFooter = $reflectionStatement.find('.social-footer');
                    $socialMediaFooter.empty();

                    var teachersReflections = statements[i].get('teachersReflections');
                    for (var j = 0; j < teachersReflections.length; j++) {
                        var $teacherReflection = $teacherReflectionRef.clone();
                        $teacherReflection.find('.teacher-reflection-author').text(teachersReflections[j].get('author').get('name'));
                        $teacherReflection.find('.teacher-reflection-statement-text').text(teachersReflections[j].get('text'));
                        $teacherReflection.appendTo($teachersReflections);
                    }

                    var reflections = statements[i].get('reflections');

                    var numDone = 0;
                    var numPending = 0;
                    var numLate = 0;

                    for (var j = 0; j < reflections.length; j++) {
                        var $socialComment = $socialCommentRef.clone();
                        $socialComment.find('.reflection-author-name').text(reflections[j].get('author').get('name'));
                        $socialComment.find('.reflection-text').text(reflections[j].get('text'));

                        if (reflections[j].get('isDone')) {
                            $socialComment.find('.reflection-status-label').text('done');
                            $socialComment.find('.reflection-status-label').addClass('label-primary');
                            numDone++;
                        }else {
                            $socialComment.find('.reflection-status-label').text('pending');
                            $socialComment.find('.reflection-status-label').addClass('label-danger');
                            numPending++;                        
                        }

                        $socialComment.appendTo($socialMediaFooter);

                    }

                    $canvas = $reflectionStatement.find('canvas');
                    $canvas.attr('id', 'canvas-' + i);
                }
                
                $('.btn-new-teacher-reflection').click(function() {
                    var studentReflectionStatementId = $(this).parents('.social-feed-box').attr('reflectionId');
                    var teacherReflectionStatementId = "P34QuDoziO";

                    var teacherReflectionStatement;
                    var studentReflectionStatement;

                    var promises = [];
                    var ReflectionStatement = Parse.Object.extend('ReflectionStatement');
                    var statementQuery = new Parse.Query(ReflectionStatement);

                    promises.push(statementQuery.get(studentReflectionStatementId).then(function(statement) {
                        studentReflectionStatement = statement;
                    }));            
                    promises.push(statementQuery.get(teacherReflectionStatementId).then(function(statement) {
                        teacherReflectionStatement = statement;
                    }));            

                    return Parse.Promise.when(promises).then(function() {
                        var currentUser = Parse.User.current();

                        var Reflection = Parse.Object.extend('Reflection');
                        var reflectionQuery = new Parse.Query(Reflection);
                        reflectionQuery.equalTo('author', currentUser);
                        reflectionQuery.equalTo('reflectionStatement', studentReflectionStatement);
                        reflectionQuery.equalTo('teacherReflectionStatement', teacherReflectionStatement);
                        reflectionQuery.find().then(function(reflections) {
                            var reflection = reflections[0];

                            $('.new-reflection-textarea').val(reflection.get('text'));
                        })
                    })

                })

                $('.btn-save-reflection').click(function() {
                    var reflectionsText = $(this).parents('form').find('textarea').val().trim();
                    var studentParsedReflections = ReflectionsParser.parse(reflectionsText);

                    if (students.length == 0) {
                        signUpStudents(studentParsedReflections).then(function() {
                            alert(students.length + ' students accounts created!');
                        })
                    }else {
                        var reflectionStatementId = $(this).parents('.social-feed-box').attr('reflectionId');
                        saveReflections(reflectionStatementId, studentParsedReflections);
                        // var promise = Parse.Promise.as();
                        // _.each(students, function(student) {
                        //     promise = promise.then(function(){
                        //         return saveReflection(student.get('email'), student.get('name'), reflections[student.get('email')], '', reflectionStatementId);
                        //     }).then(function(rs) {
                        //         console.log(rs.get('reflections').length);
                        //     })
                        // })

                        // promise.then(function() {
                        //     $('#reflections-textarea').val('');
                        //     $('#inputFirstName').val('');
                        //     $('#inputLastName').val('');
                        //     $('#inputEmail').val('');
                        //     $('#inputReflectionText').val('');
                        //     $('.user-exists').addClass('hide');
                        //     return updateReflectionStatement(reflectionStatementId);                        
                        // })

                        // var firstName = $(this).parents('form').find('#inputFirstName').val();
                        // var lastName = $(this).parents('form').find('#inputLastName').val();
                        // var email = $(this).parents('form').find('#inputEmail').val();
                        // var password = "123";
                        // var text = $(this).parents('form').find('#inputReflectionText').val();
                        // var reflectionStatementId = $(this).parents('.social-feed-box').attr('reflectionId');
                        // saveReflection(email, firstName, lastName, text, password, reflectionStatementId).then(function() {
                        //     updateReflectionStatement(reflectionStatementId);
                        // });                
                    }
                    // $(this).parents('form').find('#inputEmail').focus();
                })

                $('.social-feed-box #inputEmail').change(function() {
                    $socialFeedBox = $(this).parents('.social-feed-box');
                    var reflectionStatementId = $(this).parents('.social-feed-box').attr('reflectionId');

                    var email = $(this).val().trim();

                    var userQuery = new Parse.Query(Parse.User);
                    userQuery.equalTo('username', email);
                    userQuery.find().then(function(users) {
                        if (users.length > 0) {
                            var user = users[0];
                            $socialFeedBox.find('#inputFirstName').val(user.get('name'));
                            $socialFeedBox.find('#inputLastName').val(user.get('lastName'));
                        }
                        $socialFeedBox.find('.user-exists').removeClass('hide');
                    })
                })
            }
        }

        function signUpStudents(studentParsedReflections) {
            students = [];
            var studentsEmails = studentParsedReflections['studentsEmails'];
            var studentsReflections = studentParsedReflections['reflectionsDict'];

            var promise = Parse.Promise.as();

            _.each(studentsEmails, function(email) {
                var user = new Parse.User();
                user.set('username', email);
                user.set('email', email);
                user.set('name', studentsReflections[email]['name']);
                user.set('isStudent', true);
                user.set('password', '123');

                promise = promise.then(function() {
                    return user.signUp(null).then(function(usr) {
                        students.push(usr);
                        // Parse.User.logOut();
                    }, function(error) {
                        console.log(error);
                    });
                })
            })

            return promise;
        }

        function saveReflections(reflectionStatementId, studentParsedReflections) {
            var ReflectionStatement = Parse.Object.extend('ReflectionStatement');
            var query = new Parse.Query(ReflectionStatement);
            var reflectionStatement
            return query.get(reflectionStatementId).then(function(statement) {
                reflectionStatement = statement;
                var promises = [];
                _.each(students, function(student) {
                    var Reflection = Parse.Object.extend("Reflection");
                    var reflectionQuery = new Parse.Query(Reflection);
                    reflectionQuery.equalTo('reflectionStatement', statement);
                    reflectionQuery.equalTo('author', student);
                    promises.push(reflectionQuery.find().then(function(rfs) {
                        var reflection;
                        if (rfs.length == 0) {
                            reflection = new Reflection();
                            reflection.set('reflectionStatement', statement);
                        }else {
                            reflection = rfs[0];
                        }
                        var text = studentParsedReflections['reflectionsDict'][student.get('email')]['text'];

                        if (text == '') {
                            reflection.set('isDone', false);
                        }else {
                            reflection.set('isDone', true);
                        }
                        reflection.set('author', student);
                        reflection.set('text', text);
                        return reflection.save().then(function(rf) {
                            reflectionStatement.addUnique('reflections', rf);
                        });
                    }));
                })
                return Parse.Promise.when(promises).then(function() {
                    return reflectionStatement.save();
                });
            })
        }

        function saveReflection(email, name, text, password, reflectionId) {
            var user = new Parse.User();

            var userQuery = new Parse.Query(Parse.User);
            userQuery.equalTo('username', email);


            user.set("username", email);
            user.set("password", password);
            user.set("email", email);
            user.set("name", name);

            return userQuery.find().then(function(users) {
                if (users.length > 0) {
                    var usr = users[0];
                    var ReflectionStatement = Parse.Object.extend('ReflectionStatement');
                    var query = new Parse.Query(ReflectionStatement);
                    var reflectionStatement
                    return query.get(reflectionId).then(function(statement) {
                        reflectionStatement = statement;

                        var Reflection = Parse.Object.extend("Reflection");
                        var reflectionQuery = new Parse.Query(Reflection);
                        reflectionQuery.equalTo('reflectionStatement', statement);
                        reflectionQuery.equalTo('author', usr);
                        return reflectionQuery.find().then(function(reflections) {
                            if (reflections.length > 0) {
                                // var reflection = new Reflection();
                                var reflection = reflections[0];
                                // reflection.set('author', usr);
                                reflection.set('text', text);
                                // reflection.set('reflectionStatement', reflectionStatement);
                                if (text != '') {
                                    reflection.set('isDone', true);
                                }else {
                                    reflection.set('isDone', false);
                                }

                                return reflection.save();
                            }else {
                                var reflection = new Reflection();
                                reflection.set('author', usr);
                                reflection.set('text', text);
                                if (text == '') {
                                    reflection.set('isDone', false);
                                }else {
                                    reflection.set('isDone', true);
                                }
                                reflection.set('reflectionStatement', statement);
                                return reflection.save();
                            }
                        }) 
                    }).then(function(ref) {
                        reflectionStatement.add('reflections', ref);
                        return reflectionStatement.save();
                    })
                }else {
                    user.signUp(null, {
                      success: function(user) {
                        var usr = Parse.User.current();                
                        if (usr) {
                            $('#inputFirstName').val('');
                            $('#inputLastName').val('');
                            $('#inputEmail').val('');
                            $('#inputReflectionText').val('');
                            $('.user-exists').addClass('hide');
                            Parse.User.logOut();

                            var ReflectionStatement = Parse.Object.extend('ReflectionStatement');
                            var query = new Parse.Query(ReflectionStatement);
                            var reflectionStatement
                            query.get(reflectionId).then(function(statement) {
                                reflectionStatement = statement;

                                var Reflection = Parse.Object.extend("Reflection");
                                var reflection = new Reflection();

                                reflection.set('author', usr);
                                reflection.set('text', text);
                                if (text != '') {
                                    reflection.set('isDone', true);
                                    reflection.set('isAccepted', true);
                                }else {
                                    reflection.set('isDone', false);
                                    reflection.set('isAccepted', false);                            
                                }

                                return reflection.save();
                            }).then(function(reflect) { 
                                reflectionStatement.add('reflections', reflect);
                                return reflectionStatement.save();
                            }).then(function(statement) {
                                return updateReflectionStatement(statement.id);
                            })
                        }
                      },
                      error: function(user, error) {
                        alert("Error: " + error.code + " " + error.message);
                      }
                    });                    
                }
            });            
        }
    </script>

    <script type="text/javascript">
        var students = [];

        $(function() {
            var user = Parse.User.current();
            if (user) {
                $('#user-name').text(user.get('name'));
            }

            // Parse.User.logIn("kiev.gama@bepid.cin.ufpe.br", "123").then(function() {
                var query = new Parse.Query(Parse.User);
                query.ascending('name');
                query.limit(100);
                query.equalTo("isStudent", true);  // find all the women
                query.find().then(function(users) {
                    students = users;
                })
            // }, function(error) {
            //     Parse.User.logOut();
            // });
        })
        // if (currentUser) {
        //     Parse.User.logOut();
        // }

        var ReflectionStatement = Parse.Object.extend("ReflectionStatement");
        var query = new Parse.Query(ReflectionStatement);
        query.include('author');
        query.equalTo('isStudent', true);
        query.descending('createdAt');
        query.include('reflections.author');
        query.include('teachersReflections.author');
        query.find().then(function(statements) {
            displayReflectionStatements(statements);
            updateReflectionsMenu(statements);
        })

        $('#newReflectionModal').on("shown.bs.modal", function() {
            $('.new-reflection-textarea').focus();


        })

        $('#new-teacher-reflection-modal').on("shown.bs.modal", function() {
            $('.new-reflection-textarea').focus();
        })

        $('#btn-save-new-teacher-reflection').click(function() {
            $modal = $(this).parents('#new-teacher-reflection-modal');

            var studentReflectionStatementId = $modal.attr('student-reflection-statement-id');
            var teacherReflectionStatementId = 'P34QuDoziO';

            var ReflectionStatement = Parse.Object.extend('ReflectionStatement');
            var studentReflectionStatement;
            var teacherReflectionStatement;

            var reflectionStatementQuery = new Parse.Query(ReflectionStatement);
            var promises = [];

            promises.push(reflectionStatementQuery.get(studentReflectionStatementId).then(function(statement) {
                studentReflectionStatement = statement;
            }));
            promises.push(reflectionStatementQuery.get(teacherReflectionStatementId).then(function(statement) {
                teacherReflectionStatement = statement;
            }));

            Parse.Promise.when(promises).then(function() {
                var $textarea = $('#new-teacher-reflection-modal').find('.new-reflection-textarea');
                var text = $textarea.val().trim();

                var Reflection = Parse.Object.extend('Reflection');
                var reflection = new Reflection();

                reflection.set('author', Parse.User.current());
                reflection.set('isDone', true);
                reflection.set('reflectionStatement', studentReflectionStatement);
                reflection.set('teacherReflectionStatement', teacherReflectionStatement);
                reflection.set('text',text);
                reflection.save().then(function(ref) {
                    studentReflectionStatement.add('teachersReflections', ref);
                    $textarea.val('');
                    $modal.modal('hide');
                    return ref.save();
                });
            })
        })

        $('#btn-save-new-reflection').click(function() {
            var text = $('.new-reflection-textarea').val().trim();
            var reflections = [];

            var ReflectionStatement = Parse.Object.extend('ReflectionStatement');
            var reflectionStatement = new ReflectionStatement();
            reflectionStatement.set('author', Parse.User.current());
            reflectionStatement.set('text', text);
            reflectionStatement.set('reflections', []);
            reflectionStatement.set('teachersReflections', []);
            reflectionStatement.set('isStudent', true);
            reflectionStatement.save().then(function(statement) {
                var promise = Parse.Promise.as();
                _.each(students, function(student) {
                    var Reflection = Parse.Object.extend('Reflection');
                    var reflection = new Reflection();
                    reflection.set('author', student);
                    reflection.set('isDone', false);
                    reflection.set('reflectionStatement', statement);
                    promise = promise.then(function() {                        
                        return reflection.save().then(function(refl) {
                            reflections.push(refl);
                        });
                    })
                })
                return promise;
            }).then(function() {
                reflectionStatement.set('reflections', reflections);
                reflectionStatement.save().then(function() {
                    $('#newReflectionModal').modal('hide');
                    location.reload();
                });
            })

        })

        $('#link-logout').click(function() {
            Parse.User.logOut();
        })
        

    </script>


</body>

</html>
